---
date: 2019-02-26 22:10
status: public
title: 抖音用户关键字搜索抓包数据分析脚本使用指南
keywords: 
- 抖音
- 爬虫
- 教程
- 抓包
tags: 
- C语言
- 入门
categories: 教程
---

## 说明
参考本指南，可以通过在手机抖音APP上搜索用户，从而导出这些用户的**联系方式**、抖音ID、抖音uid、个性签名、昵称等信息。

## 工具清单
- 一台Mac OS或者Windows电脑，须安装
    - charles
    - python
- 一台安卓或者苹果手机（苹果手机未经测试），须安装
    - 抖音

## 步骤
### 1. 准备工作
- ✅ 确保电脑已安装charles和python，手机已安装charles证书。具体步骤请参考[charles设置](#charles设置)
- 打开电脑，确保与手机连接的是同一个无线网络；
- 打开charles软件和cmd窗口（mac用户请自觉使用terminal），确保charles已经开始抓包
![](https://raw.githubusercontent.com/Danceiny/baixing-helper/master/imgs/Snipaste_2019-02-22_13-22-47.png)

### 2. 找到电脑的IP地址和端口
依次按下图操作
![](https://raw.githubusercontent.com/Danceiny/baixing-helper/master/imgs/Snipaste_2019-02-22_13-18-27.png)
![](https://raw.githubusercontent.com/Danceiny/baixing-helper/master/imgs/Snipaste_2019-02-22_13-19-19.png)

### 3. 确保手机与电脑建立连接
打开手机的WLAN设置，进入当前已连接网络的高级选项设置，将代理设置为手动，主机ip设置为第2步最后一图所得到的ip地址（并确保端口号设置为8888）

操作顺序：手机设置->wifi网络长按->更多高级->设置IP、端口。

**代理设置成功后，电脑端charles可能弹出窗口说有设备连接，此时请点击Allow允许你的手机连接charles代理。**

### 4. 抖音搜索关键词
打开抖音，选择城市，然后搜索给到的关键词，不断地滑动用户列表，直至抖音APP显示没有更多结果，即完成该关键词的搜索。

### 5. 抓包数据导出

在charles中，一般需要导出两份数据，参考下图。
![](https://raw.githubusercontent.com/Danceiny/baixing-helper/master/imgs/Snipaste_2019-02-22_13-30-26.png)

找到这两个域名后，然后分别右键点击，按下图完成数据导出。
![](https://raw.githubusercontent.com/Danceiny/baixing-helper/master/imgs/Snipaste_2019-02-22_13-31-39.png)
![](https://raw.githubusercontent.com/Danceiny/baixing-helper/master/imgs/Snipaste_2019-02-22_13-34-30.png)

### 6. 提取用户信息
假定你的工作目录是"`C:/Users/baixing`"。

打开前面已经打开的cmd窗口，确保当前处于工作目录。

输入如下命令：`python douyin.py`

接下来参考提示信息即可。

## 更新脚本

下载[抖音用户关键字搜索抓包数据分析脚本](https://raw.githubusercontent.com/Danceiny/baixing-helper/master/scripts/douyin.py)到本地工作目录。（打开链接后Ctrl+S即可）

如果下载时无法选择该目录，可以先下载到其他文件夹，然后复制该文件，通过 【我的电脑】->【C盘】-> 【用户】-> 【baixing】进入到工作目录文件夹，粘贴文件即可。

## charles设置
1. 到官网下载charles。可试用30天，如需更长使用时间，请参考[charles注册码](https://github.com/Danceiny/WikiNotes/issues/3#issue-414513334)注册。
2. 为避免本机的请求数据干扰，可以禁止本机代理，参考下图（windows设备的相应选项是`windows`）。还可以到 【proxy】-> 【proxy settings】-> 【mac os】，去掉几个enable的勾选。
![](https://raw.githubusercontent.com/Danceiny/baixing-helper/master/imgs/Snipaste_2019-02-26_22-51-51.png)
3. 为开启https的抓包，须到【proxy】-> 【ssl proxy settings】-> 【ssl proxying】，点击【Add】，Host填`*`，port填`443`。如下所示
![](https://raw.githubusercontent.com/Danceiny/baixing-helper/master/imgs/Snipaste_2019-02-26_23-05-55.png)
4. 手机需要安装charles的ssl证书才能通过代理访问外网。因此，在手机连上charles代理后，请使用浏览器（最好是chrome浏览器，其他浏览器可能存在风险，依手机机型而有差异）打开网址`chls.pro/ssl`，下载证书后安装即可（证书命名可随意）。